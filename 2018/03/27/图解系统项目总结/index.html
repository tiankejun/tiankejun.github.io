<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>刺 | 图解系统项目总结</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">图解系统项目总结</h1><a id="logo" href="/.">刺</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">图解系统项目总结</h1><div class="post-meta">Mar 27, 2018</div><a class="disqus-comment-count" data-disqus-identifier="2018/03/27/图解系统项目总结/" href="/2018/03/27/图解系统项目总结/#disqus_thread"></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#项目描述"><span class="toc-number">1.</span> <span class="toc-text">项目描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#痛处"><span class="toc-number">1.1.</span> <span class="toc-text">痛处</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#重生"><span class="toc-number">1.2.</span> <span class="toc-text">重生</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#本人负责的部分"><span class="toc-number">1.3.</span> <span class="toc-text">本人负责的部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模块释义"><span class="toc-number">1.4.</span> <span class="toc-text">模块释义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#遇到的问题："><span class="toc-number">1.5.</span> <span class="toc-text">遇到的问题：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解决方案"><span class="toc-number">1.6.</span> <span class="toc-text">解决方案</span></a></li></ol></li></ol></div></div><div class="post-content"><h2 id="项目描述"><a href="#项目描述" class="headerlink" title="项目描述"></a>项目描述</h2><p>此项目是一个安防行业的项目，主要针对刑侦、技侦、公安、交警用户，为其提供根据目标（人体、人脸、车、非机动车等，以下简称目标）信息进行图片、视频查看、处理、检索的一套系统。</p>
<h3 id="痛处"><a href="#痛处" class="headerlink" title="痛处"></a>痛处</h3><p>当立项的时候，为了赶时间，赶进度，将各个子系统一由iframe嵌入的方式引用，做到一半的时候，发现以下问题：<br>1、各子系统编码规范不统一<br>2、各子系统使用技术不一致<br>3、各子系统技术文档、接口文档缺失，给维护系统带来更大的维护成本<br>4 、项目开始只是只是新需求用的vuejs， 之前有的功能直接通过iframe的方式嵌入进来，后续因为嵌入了3-4个子系统，项目维护很困难，最终决定所有功能重做</p>
<h3 id="重生"><a href="#重生" class="headerlink" title="重生"></a>重生</h3><p>为了跟进时代的潮流（组件化开发提高效率），最终项目采用vuejs渐进框架，vue-router做路由，配合webpack打包，使用git做代码仓库，利用less编写页面样式，使用Echart 进行静态或动态数据统计数据展示，使用Element UI前端UI框架</p>
<h3 id="本人负责的部分"><a href="#本人负责的部分" class="headerlink" title="本人负责的部分"></a>本人负责的部分</h3><p>主要负责<br>1、人脸检索库（第一版）<br>2、数据仓库框架搭建以及部分子模块<br>3、系统运维<br>4、车辆刻画<br>5、车辆技战法框架搭建以及部分子模块<br>的实现</p>
<h3 id="模块释义"><a href="#模块释义" class="headerlink" title="模块释义"></a>模块释义</h3><p>人脸检索库：添加人员信息到人员库，包括（图像、以及个人基本信息）；  </p>
<p>数据仓库：将摄像头抓拍的图片数据和经过录像处理后图片数据分为图文模式和列表模式两种模式展示，以及根据目标特征进行检索；  </p>
<p>系统运维：统计系统中的数据以图表的形式展示（包括目标数量统计、CPU、GPU实时信息统计）</p>
<p>车辆刻画：根据用户上传图片或者从数据仓库带过来的图片（一般是模糊不清晰的图片）外观，选择对应的条件，进行条件筛选，最终确定该车型、车款</p>
<p>车辆技战法：查询车辆某一种状态下车辆数据信息（例如：未系安全带）</p>
<h3 id="遇到的问题："><a href="#遇到的问题：" class="headerlink" title="遇到的问题："></a>遇到的问题：</h3><p>1、起初通过iframe嵌入的方式，存在iframe之间通讯问题，<br>例如，点击子组件一个按钮，弹出一个消息，这个消息要在父组件显示  </p>
<p>2、随着项目越来越大，编译速度和页面加载速度变慢问题<br>最长编译一次时间需要30s - 40s 时间，这对于开发来说无疑是噩梦</p>
<p>3、因为系统中存在权限控制，但是之前用的是jquery进行权限控制，既然使用的是数据驱动模式，如果在直接操作dom则违背vue数据驱动模式</p>
<p>4、系统中涉及到跨页勾选数据问题</p>
<p>5、由于页面复杂引入组件比较多导致页面加载慢从而影响用户体验</p>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>1、iframe数据通讯问题<br><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">发送数据</span><br><span class="line"><span class="built_in">window</span>.top.postMessage(data, <span class="built_in">url</span>);</span><br><span class="line"><span class="attribute">data</span>: 数据， </span><br><span class="line"><span class="built_in">url</span>： 发送到指定地址，</span><br><span class="line">    <span class="number">1</span>、如果是指定地址：<span class="attribute">http</span>:<span class="comment">//192.168.60.48:8080, 此时只有这个地址能收到信息，  </span></span><br><span class="line">    <span class="number">2</span>、如果是 <span class="string">"*"</span> 外层所有域都能收到</span><br><span class="line"></span><br><span class="line">监听：</span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"message"</span>, getData, <span class="literal">false</span>); <span class="comment">// 高级浏览器</span></span><br><span class="line"><span class="built_in">window</span>.attachEvent(<span class="string">"onmessage"</span>, getData);  <span class="comment">//IE</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getData</span> (<span class="params">e</span>)</span>&#123;</span><br><span class="line"> <span class="keyword">var</span> e = e || event;</span><br><span class="line"> <span class="built_in">console</span>.log(e.data) <span class="comment">// 这里接收发送的数据</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>2、提高编译和加载效率问题<br>我结合DllReferencePlugin 插件将webpack中引用的第三方包进行统一打包，在页面进行引用，这样webpack在编译打包的时候就不会将第三方包重新打包，有效提高编译效率，页面引用，这个第三包以后会被缓存下来，避免不必要的网络请求</p>
<p>3、系统中度权限问题<br>之前使用的是query来控制权限，最后我提议使用vue中的指令来控制按钮的权限，在组件加载的时候，获取按钮上绑定的指令值，根据值来判断这个按钮是否显示</p>
<p>4、跨页选择问题<br>获取后台接口的数据后，给每个对象添加<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">checked:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure></p>
<p>字段，并缓存下来，以后每次勾选或者取消勾选操作都已指向缓存数据  </p>
<p>5、页面加载慢问题<br>使用webpack ＋ vue－router 实现懒加载，提高页面加载效率，提升用户体验 </p>
<p>5.1、添加对应的webpack 配置<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">output</span>: &#123;</span><br><span class="line">    <span class="attribute">chunkFilename</span>: <span class="string">'[id].[chunkhash].js'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>5.2、文件引用统一使用路由懒加载模式<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">components</span>: &#123;</span><br><span class="line">    <span class="attribute">treeMemu</span>: function (resolve) &#123;</span><br><span class="line">      <span class="built_in">require</span>([<span class="string">'./tset.vue'</span>], resolve)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="http://yoursite.com/2018/03/27/图解系统项目总结/" data-id="cjnyom2yr0005sskxdel1uetq" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACMElEQVR42u3a224CMQxFUf7/p6nUp0oQ2PYZUOPsPI2AZmZNJcuX3G543X/X3+vHTx5//7hWv1/tfPGSIUPGtoz7y1W9Md9n9dBktyfPI0OGjAMYPMiSRaJiHpplyJAhg2xH9uEpI7+vDBkyZJCAy8NoL+zKkCFDRq+IJd/29vxqLS5DhowNGb3BwHeuPz7fkCFDxr9n5E20pHFWDdPL/WXIkDGa8foGJLJ9LhHkBztkyJAxm1EdN/ZGm7x5R4JyeSIhQ4aMzRnVAWRSlPKkk7/ccvCVIUPGhoxqWORDSp505umjDBkyZjPy/KoXUpMhgQwZMk5j9ArOamnay1V5iStDhowTGEkRy9PB5IDXm8RUhgwZBzA+8Vg8ZPORQ6HdJkOGjEGMa6eBHMxra3LsQ4YMGScwehvlbX2eFKLSV4YMGQcwrho0Vtn5tQwZMk5j9IYEPFjnY4Dla5IhQ8ZoBr999TBEMgrNg7sMGTImMXizLEnyCJKTlqmhDBkyxjF4EKy+G/JJ7/dv/g8yZMgYyuBtfQ7gxyZ4Kbt8NhkyZIxm5MGRvAj+CviRjuZ8Q4YMGRsy7sVFkrZqqK0eUX3yrQwZMkYzqsEu6upddK9ofxkyZGzLSIJsXu7yFBDNXWXIkDGaQQJfdZDJE8pqIEbtNhkyZBzJqI4/qzAe+lHXUIYMGcczkuSyWu4WDofJkCFjNCMJoL1yN0kco3abDBkyNmT0CkjyQJyd/5UMGTKGMn4AtXXRP3Yj6OMAAAAASUVORK5CYII=">分享</a><div class="tags"><a href="/tags/项目总结/">项目总结</a></div><div class="post-nav"><a class="pre" href="/2018/05/16/常用函数/">常用JavaScript函数</a><a class="next" href="/2018/03/26/hello-world/">Hello World</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论 「请确保 disqus.com 可以正常加载」</button></div><script>var disqus_shortname = '[object Object]';
var disqus_identifier = '2018/03/27/图解系统项目总结/';
var disqus_title = '图解系统项目总结';
var disqus_url = 'http://yoursite.com/2018/03/27/图解系统项目总结/';
$('.btn_click_load').click(function() {
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  $('.btn_click_load').css('display','none');
});
$.ajax({
  url: 'https://disqus.com/next/config.json',
  timeout: 3000,
  type: 'GET',
  success: (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    $('.btn_click_load').css('display','none');
  })(),
  error: function() {
    $('.btn_click_load').css('display','block');
  }
});</script><script id="dsq-count-scr" src="//[object Object].disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/VUE公共组件/" style="font-size: 15px;">VUE公共组件</a> <a href="/tags/项目总结/" style="font-size: 15px;">项目总结</a> <a href="/tags/js常用函数/" style="font-size: 15px;">js常用函数</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/10/09/height/">你知道的height，和不知道的height</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/26/VUEX使用实例/">VUEX使用实例</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/16/VUE注册全局组件及全局函数/">VUE组册全局组件以及全局函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/16/常用函数/">常用JavaScript函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/27/图解系统项目总结/">图解系统项目总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/26/hello-world/">Hello World</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//[object Object].disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018  Powered by<a rel="nofollow" target="_blank" href="https://tiankejun.github.io"> TIANKEJUN.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = '//hm.baidu.com/hm.js?' + 'true';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>